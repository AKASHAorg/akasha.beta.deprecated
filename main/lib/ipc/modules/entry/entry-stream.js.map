{"version":3,"file":"entry-stream.js","sourceRoot":"","sources":["entry-stream.ts"],"names":[],"mappings":";AAAA,MAAY,OAAO,WAAM,UAAU,CAAC,CAAA;AACpC,wBAAyC,uBAAuB,CAAC,CAAA;AACjE,kCAA2B,4BAA4B,CAAC,CAAA;AACxD,6BAAsB,oBAAoB,CAAC,CAAA;AAM3C,MAAM,OAAO,GAAG,OAAO,CAAC,SAAS,CAAC,WAAU,IAA0B;IAClE,IAAI,MAAM,GAAG,MAAM,yBAAc,CAAC,OAAO,CAAC,EAAE,QAAQ,EAAE,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC;IACvE,IAAI,MAAM,GAAG,MAAM,oBAAS,CAAC,OAAO,CAAC,EAAE,QAAQ,EAAE,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC;IAClE,MAAM,gBAAgB,GAAG,EAAE,CAAC;IAC5B,MAAM,UAAU,GAAG,EAAE,CAAC;IACtB,MAAM,GAAG,QAAQ,CAAC,MAAM,CAAC,CAAC;IAC1B,MAAM,GAAG,QAAQ,CAAC,MAAM,CAAC,CAAC;IAC1B,IAAI,aAAa,GAAG,MAAM,mBAAS,CAAC,QAAQ,CAAC,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;IACnF,IAAI,SAAS,GAAG,MAAM,mBAAS,CAAC,QAAQ,CAAC,OAAO,CAAC,KAAK,CAAC,aAAa,CAAC,CAAC;IACtE,gBAAgB,CAAC,IAAI,CAAC,EAAC,cAAc,EAAE,aAAa,EAAE,QAAQ,EAAE,SAAS,EAAC,CAAC,CAAC;IAC5E,OAAM,MAAM,EAAE,CAAC;QACX,aAAa,GAAG,MAAM,mBAAS,CAAC,QAAQ,CAAC,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,QAAQ,EAAE,aAAa,CAAC,CAAC;QAC7F,SAAS,GAAG,MAAM,mBAAS,CAAC,QAAQ,CAAC,OAAO,CAAC,KAAK,CAAC,aAAa,CAAC,CAAC;QAClE,gBAAgB,CAAC,IAAI,CAAC,EAAC,cAAc,EAAE,aAAa,EAAE,QAAQ,EAAE,SAAS,EAAC,CAAC,CAAC;QAC5E,MAAM,EAAE,CAAC;IACb,CAAC;IAED,IAAI,UAAU,GAAG,MAAM,mBAAS,CAAC,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;IACxE,IAAI,OAAO,GAAG,MAAM,mBAAS,CAAC,QAAQ,CAAC,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC;IACnE,UAAU,CAAC,IAAI,CAAC,EAAC,KAAK,EAAE,UAAU,EAAE,OAAO,EAAE,OAAO,EAAC,CAAC,CAAC;IACvD,OAAM,MAAM,EAAE,CAAC;QACX,UAAU,GAAG,MAAM,mBAAS,CAAC,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,QAAQ,EAAE,UAAU,CAAC,CAAC;QAC/E,OAAO,GAAG,MAAM,mBAAS,CAAC,QAAQ,CAAC,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC;QAC/D,UAAU,CAAC,IAAI,CAAC,EAAC,KAAK,EAAE,UAAU,EAAE,OAAO,EAAE,OAAO,EAAC,CAAC,CAAC;QACvD,MAAM,EAAE,CAAC;IACb,CAAC;IAED,MAAM,CAAC,EAAE,QAAQ,EAAE,gBAAgB,EAAE,IAAI,EAAE,UAAU,EAAE,QAAQ,EAAE,IAAI,CAAC,QAAQ,EAAE,CAAC;AACrF,CAAC,CAAC,CAAC;AAEH;kBAAe,EAAE,OAAO,EAAE,IAAI,EAAE,kBAAkB,EAAE,CAAC","sourcesContent":["import * as Promise from 'bluebird';\nimport { constructed as contracts } from '../../contracts/index';\nimport followingCount from '../profile/following-count';\nimport subsCount from '../tags/subs-count';\n\n/**\n * Get score of an entry\n * @type {Function}\n */\nconst execute = Promise.coroutine(function*(data: { akashaId: string }) {\n    let fCount = yield followingCount.execute({ akashaId: data.akashaId });\n    let sCount = yield subsCount.execute({ akashaId: data.akashaId });\n    const followedProfiles = [];\n    const subbedTags = [];\n    fCount = parseInt(fCount);\n    sCount = parseInt(sCount);\n    let currentFollow = yield contracts.instance.feed.getFollowingFirst(data.akashaId);\n    let profileId = yield contracts.instance.profile.getId(currentFollow);\n    followedProfiles.push({profileAddress: currentFollow, akashaId: profileId});\n    while(fCount) {\n        currentFollow = yield contracts.instance.feed.getFollowingNext(data.akashaId, currentFollow);\n        profileId = yield contracts.instance.profile.getId(currentFollow);\n        followedProfiles.push({profileAddress: currentFollow, akashaId: profileId});\n        fCount--;\n    }\n\n    let currentSub = yield contracts.instance.feed.subsFirst(data.akashaId);\n    let tagName = yield contracts.instance.tags.getTagName(currentSub);\n    subbedTags.push({tagId: currentSub, tagName: tagName});\n    while(sCount) {\n        currentSub = yield contracts.instance.feed.subsNext(data.akashaId, currentSub);\n        tagName = yield contracts.instance.tags.getTagName(currentSub);\n        subbedTags.push({tagId: currentSub, tagName: tagName});\n        sCount--;\n    }\n\n    return { profiles: followedProfiles, tags: subbedTags, akashaId: data.akashaId };\n});\n\nexport default { execute, name: 'getEntriesStream' };\n"]}