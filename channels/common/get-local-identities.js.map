{"version":3,"file":"get-local-identities.js","sourceRoot":"","sources":["get-local-identities.ts"],"names":[],"mappings":"AAAA,OAAO,KAAK,OAAO,MAAM,UAAU,CAAC;AACpC,OAAO,EAAE,IAAI,EAAE,MAAM,OAAO,CAAC;AAC7B,OAAO,EAAE,aAAa,EAAE,WAAW,EAAE,cAAc,EAAE,MAAM,aAAa,CAAC;AAEzE,MAAM,CAAC,OAAO,UAAU,IAAI,CAAC,EAAE,EAAE,UAAU;IACzC,MAAM,OAAO,GAAG,OAAO,CAAC,SAAS,CAAC,QAAQ,CAAC;QACzC,MAAM,OAAO,GAAG,UAAU,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;QACjD,MAAM,UAAU,GAAG,UAAU,CAAC,cAAc,CAAC,YAAY,CAAC,CAAC;QAC3D,MAAM,QAAQ,GAAG,MAAM,OAAO,CAAC,QAAQ,CAAC,GAAG,CAAC,WAAW,EAAE,CAAC;QAC1D,IAAI,CAAC,QAAQ,IAAI,CAAC,QAAQ,CAAC,MAAM,EAAE;YACjC,OAAO,EAAE,UAAU,EAAE,EAAE,EAAE,CAAC;SAC3B;QACD,MAAM,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC,CAAC,GAAG,CAAC,CAAC,OAAe,EAAE,EAAE;YACtD,OAAO,UAAU,CAAC,OAAO,CAAC,EAAE,UAAU,EAAE,OAAO,EAAE,CAAC,CAAC;QACrD,CAAC,CAAC,CAAC;QACH,MAAM,UAAU,GAAG,MAAM,OAAO,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;QAC/C,OAAO,EAAE,UAAU,EAAE,UAAU,IAAI,EAAE,EAAE,CAAC;IAC1C,CAAC,CAAC,CAAC;IAEH,MAAM,kBAAkB,GAAG,EAAE,OAAO,EAAE,IAAI,EAAE,oBAAoB,EAAE,CAAC;IACnE,MAAM,OAAO,GAAG;QACd,OAAO,kBAAkB,CAAC;IAC5B,CAAC,CAAC;IACF,EAAE,EAAE,CAAC,OAAO,CAAC,aAAa,CAAC,kBAAkB,EAAE,OAAO,CAAC,CAAC;IACxD,OAAO,kBAAkB,CAAC;AAC5B,CAAC","sourcesContent":["import * as Promise from 'bluebird';\nimport { uniq } from 'ramda';\nimport { COMMON_MODULE, CORE_MODULE, PROFILE_MODULE } from './constants';\n\nexport default function init(sp, getService) {\n  const execute = Promise.coroutine(function* () {\n    const web3Api = getService(CORE_MODULE.WEB3_API);\n    const resolveEth = getService(PROFILE_MODULE.getByAddress);\n    const accounts = yield web3Api.instance.eth.getAccounts();\n    if (!accounts || !accounts.length) {\n      return { collection: [] };\n    }\n    const profiles = uniq(accounts).map((address: string) => {\n      return resolveEth.execute({ ethAddress: address });\n    });\n    const collection = yield Promise.all(profiles);\n    return { collection: collection || [] };\n  });\n\n  const getLocalIdentities = { execute, name: 'getLocalIdentities' };\n  const service = function () {\n    return getLocalIdentities;\n  };\n  sp().service(COMMON_MODULE.getLocalIdentities, service);\n  return getLocalIdentities;\n}\n"]}